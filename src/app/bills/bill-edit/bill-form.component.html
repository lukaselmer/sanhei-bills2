<form [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>
  <mat-card formArrayName="articles">
    <mat-card-title>Artikel</mat-card-title>
    <mat-card-content>
      <div *ngFor="let article of articlesForm.controls; let i=index" [formGroupName]="i" class="article">
        <div>
          <mat-form-field>
            <input matInput formControlName="catalogId" placeholder="Katalognr.">
          </mat-form-field>
        </div>
        <div>
          <mat-form-field>
            <input #articleDescription matInput (focus)="articleFocus(articleDescription.value)" formControlName="description" placeholder="Beschreibung"
              [matAutocomplete]="articleDescriptionAuto">
          </mat-form-field>
          <mat-autocomplete #articleDescriptionAuto="matAutocomplete">
            <mat-option *ngFor="let option of autocompleteOptions['articleDescription'] | async" [value]="option">
              {{ option }}
            </mat-option>
          </mat-autocomplete>
        </div>
        <div>
          <mat-form-field>
            <input matInput formControlName="dimension" placeholder="Dimension">
          </mat-form-field>
        </div>
        <div>
          <mat-form-field>
            <input matInput formControlName="price" placeholder="Preis">
          </mat-form-field>
        </div>
        <div>
          <mat-form-field>
            <input matInput formControlName="amount" placeholder="Anzahl">
          </mat-form-field>
        </div>
        <div>
          <button mat-icon-button type="button" (click)="removeArticleAt(i)">
            <i class="material-icons">delete</i>
          </button>
        </div>
      </div>
    </mat-card-content>
    <mat-card-actions>
      <button mat-button type="button" (click)="addNewArticle(1)">1 ARTIKEL HINZUFÜGEN</button>
      <button mat-button type="button" (click)="addNewArticle(5)">5 ARTIKEL HINZUFÜGEN</button>
      <button mat-button type="button" (click)="addNewArticle(10)">10 ARTIKEL HINZUFÜGEN</button>
    </mat-card-actions>
  </mat-card>

  <mat-card>
    <mat-form-field>
      <input matInput formControlName="billType" placeholder="Art (Rechnung / Offerte / Spezial)" [matAutocomplete]="billTypeAuto">
    </mat-form-field>
    <mat-autocomplete #billTypeAuto="matAutocomplete">
      <mat-option *ngFor="let option of autocompleteOptions['billType'] | async" [value]="option">
        {{ option }}
      </mat-option>
    </mat-autocomplete>

    <mat-form-field>
      <input matInput formControlName="title" placeholder="Titel Rechnung" [matAutocomplete]="titleAuto">
    </mat-form-field>
    <mat-autocomplete #titleAuto="matAutocomplete">
      <mat-option *ngFor="let option of autocompleteOptions['title'] | async" [value]="option">
        {{ option }}
      </mat-option>
    </mat-autocomplete>

    <mat-form-field>
      <textarea matInput formControlName="address" matTextareaAutosize placeholder="Adresse" [matAutocomplete]="addressAuto"></textarea>
    </mat-form-field>
    <mat-autocomplete #addressAuto="matAutocomplete">
      <mat-option *ngFor="let option of autocompleteOptions['address'] | async" [value]="option">
        {{ option }}
      </mat-option>
    </mat-autocomplete>

    <mat-form-field>
      <input matInput formControlName="ownerName" placeholder="Eigentümer" [matAutocomplete]="ownerNameAuto">
    </mat-form-field>
    <mat-autocomplete #ownerNameAuto="matAutocomplete">
      <mat-option *ngFor="let option of autocompleteOptions['ownerName'] | async" [value]="option">
        {{ option }}
      </mat-option>
    </mat-autocomplete>

    <mat-form-field>
      <input matInput formControlName="ordererName" placeholder="Auftraggeber/Nr" [matAutocomplete]="ordererNameAuto">
    </mat-form-field>
    <mat-autocomplete #ordererNameAuto="matAutocomplete">
      <mat-option *ngFor="let option of autocompleteOptions['ordererName'] | async" [value]="option">
        {{ option }}
      </mat-option>
    </mat-autocomplete>
  </mat-card>

  <mat-card>
    <mat-form-field>
      <input matInput formControlName="descriptionTitle" placeholder="Titel Beschreibung" [matAutocomplete]="descriptionTitleAuto">
    </mat-form-field>
    <mat-autocomplete #descriptionTitleAuto="matAutocomplete">
      <mat-option *ngFor="let option of autocompleteOptions['descriptionTitle'] | async" [value]="option">
        {{ option }}
      </mat-option>
    </mat-autocomplete>

    <mat-form-field>
      <textarea matInput formControlName="description" matTextareaAutosize placeholder="Arbeitsbeschreibung" [matAutocomplete]="descriptionAuto"></textarea>
    </mat-form-field>
    <mat-autocomplete #descriptionAuto="matAutocomplete">
      <mat-option *ngFor="let option of autocompleteOptions['description'] | async" [value]="option">
        {{ option }}
      </mat-option>
    </mat-autocomplete>
  </mat-card>

  <mat-card>
    <mat-form-field>
      <input matInput formControlName="workedAt" placeholder="Ausgeführte Arbeiten am (Freitext oder yyyy-mm-dd, yyyy-mm-dd, ... als Datum)">
    </mat-form-field>
    <mat-form-field>
      <input matInput formControlName="orderedAt" placeholder="Auftragsdatum (yyyy-mm-dd)">
    </mat-form-field>
    <mat-form-field>
      <input matInput formControlName="billedAt" placeholder="Verrechnet am (yyyy-mm-dd)">
    </mat-form-field>
  </mat-card>

  <mat-card>
    <mat-form-field>
      <input matInput formControlName="cashback" placeholder="Skonto in %">
    </mat-form-field>
    <mat-form-field>
      <input matInput formControlName="vat" placeholder="MWST in %">
    </mat-form-field>
    <mat-form-field>
      <input matInput formControlName="discount" placeholder="Rabatt">
    </mat-form-field>
  </mat-card>

  <button mat-raised-button color="primary" type="submit">SPEICHERN</button>

  <button mat-raised-button class="abort-button" type="button" (click)="abort()">ABBRECHEN</button>

  <button mat-fab color="primary" class="floating-save-button" type="submit">
    <mat-icon class="md-24" aria-label="Speichern">save</mat-icon>
  </button>
</form>
